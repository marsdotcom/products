package com.example.koldun.product;


import android.content.ContentValues;
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

/**
 * Created by koldun on 07.01.2017.
 */

public class DBHelper extends SQLiteOpenHelper {

    public static String[] values ={
            "_id,name,alias\n"+
            "1,АЕСФ.321231.001,двухэтажные\n" +
            "2,АЕСФ.321231.004,стаканчики\n" +
            "3,АЕСФ.321231.005,_\n" +
            "4,АЕСФ.321231.006,_\n" +
            "5,АЕСФ.321233.001,глухари\n" +
            "6,АЕСФ.321233.002,калашники\n" +
            "7,АЕСФ.464966.003,балки простые\n" +
            "8,АЕСФ.464966.004-01,балки сложные\n" +
            "9,АЕСФ.464966.006-01,курятники\n" +
            "10,АЕСФ.464966.017,одноэтажные\n" +
            "11,ВАИШ.321213.001,мелочи\n" +
            "12,ВАИШ.321233.005,с вкладышами\n" +
            "13,ВАИШ.321233.007,_\n" +
            "14,ВАИШ.321233.008,_\n" +
            "15,АЕСФ.464966.003-06,балки простые\n" +
            "16,АЕСФ.464966.003-07,балки простые\n" +
            "17,АЕСФ.464966.003-08,балки простые\n" +
            "18,АЕСФ.464966.003-09,балки простые\n" +
            "19,АЕСФ.464966.018,одноэтажные\n" +
            "20,АЕСФ.464966.019,одноэтажные\n" +
            "21,ВАИШ.321233.003,_\n" +
            "22,АЕСФ.321212.001,_\n" +
            "23,АЕСФ.321231.003,_\n" +
            "24,ВАИШ.465846.172,_",


            "_id,order_n,product,price,job\n"+
            "1,11,1,10000,2000\n" +
            "2,11,2,7000,1000\n" +
            "3,11,3,8000,1600\n" +
            "4,11,4,4500,1000\n" +
            "5,11,5,6000,1500\n" +
            "6,11,6,4000,1000\n" +
            "7,11,7,8500,1500\n" +
            "8,11,8,10000,2000\n" +
            "9,11,9,7500,1500\n" +
            "10,11,10,6000,1300\n" +
            "11,11,11,3500,700\n" +
            "12,11,12,7500,2000\n" +
            "13,11,13,5000,1000\n" +
            "14,11,14,4500,1000\n" +
            "15,2,1,9000,2000\n" +
            "16,2,2,6500,1000\n" +
            "17,2,3,7000,1500\n" +
            "18,2,4,4000,1000\n" +
            "19,2,5,5500,1000\n" +
            "20,2,6,3500,500\n" +
            "21,2,7,7500,1500\n" +
            "22,2,8,8000,2000\n" +
            "23,2,9,7000,1500\n" +
            "24,2,10,5000,1000\n" +
            "25,2,11,3200,500\n" +
            "26,2,12,7000,2000\n" +
            "27,2,13,5000,1000\n" +
            "28,2,14,4200,1000",


            "_id,n_id,width,length,count\n"+
            "1,14,1440,790,2\n" +
            "2,14,720,790,2\n" +
            "3,14,620,720,4\n" +
            "4,14,1440,620,2\n" +
            "5,13,820,1100,1\n" +
            "6,13,720,1100,2\n" +
            "7,13,720,750,2\n" +
            "8,1,880,845,2\n" +
            "9,1,750,1600,4\n" +
            "10,1,750,880,4\n" +
            "11,10,880,845,2\n" +
            "12,10,750,1600,2\n" +
            "13,10,750,880,2\n" +
            "14,12,1460,820,2\n" +
            "15,12,1460,720,2\n" +
            "16,12,1580,720,2\n" +
            "17,12,1460,1650,1\n" +
            "18,11,850,550,2\n" +
            "19,11,1000,550,2\n" +
            "20,11,760,1000,2\n" +
            "21,2,750,840,2\n" +
            "22,2,750,800,8\n" +
            "23,3,630,1290,2\n" +
            "24,3,630,670,2\n" +
            "25,3,630,950,2\n" +
            "26,3,950,1330,1\n" +
            "27,3,950,720,1\n" +
            "28,4,710,940,1\n" +
            "29,4,710,580,2\n" +
            "30,4,580,850,2\n" +
            "31,19,880,845,2\n" +
            "32,19,750,1600,2\n" +
            "33,19,750,880,2\n" +
            "34,20,880,845,2\n" +
            "35,20,750,1600,2\n" +
            "36,20,750,880,2",


            "_id,number,date,product,count\n"+
            "1,2,0,22,1\n" +
            "2,2,0,21,2\n" +
            "3,2,0,12,24\n" +
            "4,2,0,13,3\n" +
            "5,2,0,14,8\n" +
            "6,2,0,1,16\n" +
            "7,2,0,5,4\n" +
            "8,2,0,6,4\n" +
            "9,2,0,10,12\n" +
            "10,2,0,19,4\n" +
            "11,3,0,3,5\n" +
            "12,3,0,4,5\n" +
            "13,3,0,21,2\n" +
            "14,3,0,12,24\n" +
            "15,3,0,13,2\n" +
            "16,3,0,14,4\n" +
            "17,3,0,1,16\n" +
            "18,3,0,5,4\n" +
            "19,3,0,6,4\n" +
            "20,3,0,10,12\n" +
            "21,3,0,19,4\n" +
            "22,3,0,20,4\n" +
            "23,4,0,22,5\n" +
            "24,4,0,23,5\n" +
            "25,4,0,12,24\n" +
            "26,4,0,13,4\n" +
            "27,4,0,14,8\n" +
            "28,4,0,24,5\n" +
            "29,4,0,1,16\n" +
            "30,4,0,2,4\n" +
            "31,4,0,5,8\n" +
            "32,4,0,6,4\n" +
            "33,4,0,9,4\n" +
            "34,4,0,10,12\n" +
            "35,4,0,19,4\n" +
            "36,4,0,20,4\n" +
            "37,4,0,3,10\n" +
            "38,4,0,4,10\n" +
            "39,4,0,11,20\n" +
            "40,5,0,12,24\n" +
            "41,5,0,11,14\n" +
            "42,5,0,5,4\n" +
            "43,5,0,9,4\n" +
            "44,5,0,8,4\n" +
            "45,5,0,7,16\n" +
            "46,6,0,1,8\n" +
            "47,6,0,2,5\n" +
            "48,6,0,5,12\n" +
            "49,6,0,6,3\n" +
            "50,6,0,15,2\n" +
            "51,6,0,16,2\n" +
            "52,6,0,17,2\n" +
            "53,6,0,18,2\n" +
            "54,6,0,8,4\n" +
            "55,6,0,9,4\n" +
            "56,6,0,10,9\n" +
            "57,6,0,19,3\n" +
            "58,6,0,20,3\n" +
            "59,6,0,12,24\n" +
            "60,6,0,13,2\n" +
            "61,6,0,14,4\n" +
            "62,7,0,12,24\n" +
            "63,7,0,13,2\n" +
            "64,7,0,14,4\n" +
            "65,8,0,1,8\n" +
            "66,8,0,2,2\n" +
            "67,8,0,5,6\n" +
            "68,8,0,15,2\n" +
            "69,8,0,16,2\n" +
            "70,8,0,17,2\n" +
            "71,8,0,18,2\n" +
            "72,8,0,8,2\n" +
            "73,8,0,10,6\n" +
            "74,8,0,19,2\n" +
            "75,8,0,20,2\n" +
            "76,9,0,11,20\n" +
            "77,9,0,12,12\n" +
            "78,9,0,13,1\n" +
            "79,9,0,14,2\n" +
            "80,10,0,1,8\n" +
            "81,10,0,2,2\n" +
            "82,10,0,5,6\n" +
            "83,10,0,15,2\n" +
            "84,10,0,16,2\n" +
            "85,10,0,17,2\n" +
            "86,10,0,18,2\n" +
            "87,10,0,8,2\n" +
            "88,10,0,10,6\n" +
            "89,10,0,19,2\n" +
            "90,10,0,20,2\n" +
            "91,11,0,3,5\n" +
            "92,11,0,4,5\n" +
            "93,11,0,11,20\n" +
            "94,11,0,12,12\n" +
            "95,11,0,13,1\n" +
            "96,11,0,14,2\n" +
            "97,12,0,1,8\n" +
            "98,12,0,2,2\n" +
            "99,12,0,5,6\n" +
            "100,12,0,6,2\n" +
            "101,12,0,15,2\n" +
            "102,12,0,16,2\n" +
            "103,12,0,17,2\n" +
            "104,12,0,18,2\n" +
            "105,12,0,8,4\n" +
            "106,12,0,9,4\n" +
            "107,12,0,10,6\n" +
            "108,12,0,19,2\n" +
            "109,12,0,20,2\n" +
            "110,13,0,1,12\n" +
            "111,13,0,2,3\n" +
            "112,13,0,5,9\n" +
            "113,13,0,6,3\n" +
            "114,13,0,15,3\n" +
            "115,13,0,16,3\n" +
            "116,13,0,17,3\n" +
            "117,13,0,18,3\n" +
            "118,13,0,8,6\n" +
            "119,13,0,9,6\n" +
            "120,13,0,10,9\n" +
            "121,13,0,19,3\n" +
            "122,13,0,20,3\n" +
            "123,15,0,1,8\n" +
            "124,15,0,15,1\n" +
            "125,15,0,16,1\n" +
            "126,15,0,17,1\n" +
            "127,15,0,18,1\n" +
            "128,15,0,10,3\n" +
            "129,15,0,19,1\n" +
            "130,15,0,20,1\n" +
            "131,16,0,1,8\n" +
            "132,16,0,2,2\n" +
            "133,16,0,5,6\n" +
            "134,16,0,6,2\n" +
            "135,16,0,15,2\n" +
            "136,16,0,16,2\n" +
            "137,16,0,17,2\n" +
            "138,16,0,18,2\n" +
            "139,16,0,8,4\n" +
            "140,16,0,9,4\n" +
            "141,16,0,10,6\n" +
            "142,16,0,19,2\n" +
            "143,16,0,20,2",


            "_id,n_id,size,length,count\n"+
            "1,6,25х70,450,4\n" +
            "2,6,25х70,378,2\n" +
            "3,6,25х70,538,6\n" +
            "4,6,25х70,290,4\n" +
            "5,6,19x100,1090,12\n" +
            "6,6,19x93,1090,18\n" +
            "7,6,19x100,500,12\n" +
            "8,6,60x100,538,3\n" +
            "9,14,32х50,2160,6\n" +
            "10,14,32х50,690,4\n" +
            "11,14,32х50,620,8\n" +
            "12,14,32х50,520,8\n" +
            "13,14,50х50,790,4\n" +
            "14,13,32х50,1100,6\n" +
            "15,13,32х50,720,7\n" +
            "16,13,32х50,650,4\n" +
            "17,13,32х50,620,4\n" +
            "18,13,100х100,820,3\n" +
            "19,13,25х91,1100,9\n" +
            "20,1,40х75,1690,2\n" +
            "21,1,40х75,730,3\n" +
            "22,1,40х75,1600,4\n" +
            "23,1,40х50,1600,4\n" +
            "24,1,40х75,880,8\n" +
            "25,1,40х50,880,4\n" +
            "26,1,40х75,625,20\n" +
            "27,1,19х98,1690,9\n" +
            "28,1,19х100,880,5\n" +
            "29,1,19х100,1690,3\n" +
            "30,1,100х100,100,9\n" +
            "31,10,40х75,1690,2\n" +
            "32,10,40х75,730,3\n" +
            "33,10,40х75,1600,2\n" +
            "34,10,40х50,1600,2\n" +
            "35,10,40х75,880,4\n" +
            "36,10,40х50,880,2\n" +
            "37,10,40х75,625,10\n" +
            "38,10,19х98,1690,9\n" +
            "39,10,19х100,880,5\n" +
            "40,10,19х100,1690,3\n" +
            "41,10,100х100,100,9\n" +
            "42,12,32х50,1460,8\n" +
            "43,12,32х50,1580,4\n" +
            "44,12,32х50,1550,2\n" +
            "45,12,32х50,1360,1\n" +
            "46,12,32х50,620,14\n" +
            "47,12,45х50,1650,4\n" +
            "48,12,32х100,1430,2\n" +
            "49,12,32х90,1355,2\n" +
            "50,12,32х105,720,4\n" +
            "51,11,40х50,900,8\n" +
            "52,11,40х50,850,4\n" +
            "53,11,40х50,762,4\n" +
            "54,11,40х50,550,4\n" +
            "55,11,40х50,450,8\n" +
            "56,9,25х75,2490,20\n" +
            "57,9,25х75,620,10\n" +
            "58,9,40х75,710,8\n" +
            "59,9,40х75,670,6\n" +
            "60,9,40х75,510,4\n" +
            "61,9,40х75,470,4\n" +
            "62,9,40х75,625,3\n" +
            "63,9,75x125,670,4\n" +
            "64,8,25х125,2400,7\n" +
            "65,8,40х75,250,1\n" +
            "66,8,40х75,770,4\n" +
            "67,8,60х100,3200,2\n" +
            "68,8,60х100,1700,24\n" +
            "69,7,25х125,2400,6\n" +
            "70,7,40х75,560,4\n" +
            "71,7,60х100,3200,2\n" +
            "72,7,60х100,1700,18\n" +
            "73,2,40х50,750,20\n" +
            "74,2,40х50,700,16\n" +
            "75,2,40х75,750,2\n" +
            "76,2,40х75,690,3\n" +
            "77,2,19х75,750,2\n" +
            "78,2,19х75,690,3\n" +
            "79,2,60х100,750,3\n" +
            "80,5,25х70,780,6\n" +
            "81,5,25х70,836,5\n" +
            "82,5,25х70,600,4\n" +
            "83,5,19x93,1775,13\n" +
            "84,5,19x93,1775,18\n" +
            "85,5,19x93,797,13\n" +
            "86,3,40х75,2050,2\n" +
            "87,3,40х75,800,4\n" +
            "88,3,40х75,1962,4\n" +
            "89,3,40х75,480,14\n" +
            "90,3,40х75,950,6\n" +
            "91,3,19х95,2050,10\n" +
            "92,3,19х100,950,5\n" +
            "93,3,19х100,2050,3\n" +
            "94,3,100х100,100,15\n" +
            "95,4,40х75,940,2\n" +
            "96,4,40х75,560,3\n" +
            "97,4,40х75,852,4\n" +
            "98,4,40х75,430,10\n" +
            "99,4,40х75,710,6\n" +
            "100,4,19х89,940,8\n" +
            "101,4,19х100,940,2\n" +
            "102,4,19х100,710,3\n" +
            "103,4,100х100,100,6\n" +
            "104,15,25х125,2400,6\n" +
            "105,15,40х75,560,4\n" +
            "106,15,60х100,3200,2\n" +
            "107,15,60х100,1700,18\n" +
            "108,16,25х125,2400,6\n" +
            "109,16,40х75,560,4\n" +
            "110,16,60х100,3200,2\n" +
            "111,16,60х100,1700,18\n" +
            "112,17,25х125,2400,6\n" +
            "113,17,40х75,560,4\n" +
            "114,17,60х100,3200,2\n" +
            "115,17,60х100,1700,18\n" +
            "116,18,25х125,2400,6\n" +
            "117,18,40х75,560,4\n" +
            "118,18,60х100,3200,2\n" +
            "119,18,60х100,1700,18\n" +
            "120,19,40х75,1690,2\n" +
            "121,19,40х75,730,3\n" +
            "122,19,40х75,1600,2\n" +
            "123,19,40х50,1600,2\n" +
            "124,19,40х75,880,4\n" +
            "125,19,40х50,880,2\n" +
            "126,19,40х75,625,10\n" +
            "127,19,19х98,1690,9\n" +
            "128,19,19х100,880,5\n" +
            "129,19,19х100,1690,3\n" +
            "130,19,100х100,100,9\n" +
            "131,20,40х75,1690,2\n" +
            "132,20,40х75,730,3\n" +
            "133,20,40х75,1600,2\n" +
            "134,20,40х50,1600,2\n" +
            "135,20,40х75,880,4\n" +
            "136,20,40х50,880,2\n" +
            "137,20,40х75,625,10\n" +
            "138,20,19х98,1690,9\n" +
            "139,20,19х100,880,5\n" +
            "140,20,19х100,1690,3\n" +
            "141,20,100х100,100,9"};
    
    public static String[] tablenames ={"products","prices","plywoods","orders","battens"};

    private static String[] sql = {
            "CREATE TABLE products (_id INTEGER PRIMARY KEY AUTOINCREMENT,name text,alias text);",
            "CREATE TABLE prices   (_id INTEGER PRIMARY KEY AUTOINCREMENT,order_n INTEGER,          product INTEGER,price INTEGER,  job INTEGER);",
            "CREATE TABLE plywoods (_id INTEGER PRIMARY KEY AUTOINCREMENT,n_id INTEGER NOT NULL,    width INTEGER,  length INTEGER, count INTEGER);",
            "CREATE TABLE orders   (_id INTEGER PRIMARY KEY AUTOINCREMENT,number INTEGER NOT NULL,  date TEXT,      product TEXT,   count INTEGER);",
            "CREATE TABLE battens  (_id INTEGER PRIMARY KEY AUTOINCREMENT,n_id INTEGER NOT NULL,    size TEXT,      length INTEGER, count INTEGER);"};


    static final int DBVersion = 2;

    public DBHelper(Context context) {
        super(context, "MyDB", null, DBVersion);
    }



    @Override
    public void onCreate(SQLiteDatabase db) {

        for (int i=0;i<values.length;i++) {

            db.execSQL(sql[i]);
            FillTable(db,values[i],tablenames[i]);

        }

    }


    public long FillTable(SQLiteDatabase db, String value,String table){

        long r=0;

        ContentValues cv = new ContentValues();

        String[] lines = value.split("\n");

        String[] columns = lines[0].split(",");

        for (int i=1;i<lines.length;i++) {

            String[] data = lines[i].split(",");

            for (int j = 0; j < columns.length ; j++) { cv.put(columns[j],data[j]); }

            r += db.insert(table, null, cv);

        }

        return r;
    }


    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        if (oldVersion == 1 && newVersion == 2) {

            db.beginTransaction();
            try {

                db.execSQL("alter table products add column alias text");

                ContentValues cv = new ContentValues();

                String[] lines = values[0].split("\n");

                String[] columns = lines[0].split(",");

                for (int i = 1; i < lines.length; i++) {

                    String[] data = lines[i].split(",");

                    cv.put(columns[2], data[2]);

                    db.update(tablenames[0], cv, "_id=?", new String[]{data[0]});

                }
                db.setTransactionSuccessful();
            }finally {
                db.endTransaction();
            }

        }
    }
}
